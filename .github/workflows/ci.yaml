name: CI

on: [push, pull_request]

jobs:
  tests:
    name: Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install Neovim
        run: |
          sudo apt-get update
          sudo apt install libfuse2
          wget https://github.com/neovim/neovim/releases/download/nightly/nvim.appimage
          chmod u+x nvim.appimage
          sudo mv nvim.appimage /usr/bin/nvim
      - name: Setup
        run: make setup
      - name: Execute tests
        run: make test EXTRA_OPTIONS='--headless'
